<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <!-- <link rel="shortcut icon" href="../../docs-assets/ico/favicon.png"> -->

        <title>3 in a row</title>

        <!-- Bootstrap core CSS -->
        <link rel="stylesheet" href="/styles/bootstrap.min.css">
    </head>
    
    <body>
        <div class="container">
            <div class="row" rel="1">
                <div class="col-xs-4" rel="1">
                    <a href="javascript:;" class="btn">[ ]</a>
                </div>
                <div class="col-xs-4" rel="2">
                    <a href="javascript:;" class="btn">[ ]</a>
                </div>
                <div class="col-xs-4" rel="4">
                    <a href="javascript:;" class="btn">[ ]</a>
                </div>
            </div>
            <div class="row" rel="2">
                <div class="col-xs-4" rel="8">
                    <a href="javascript:;" class="btn">[ ]</a>
                </div>
                <div class="col-xs-4" rel="16">
                    <a href="javascript:;" class="btn">[ ]</a>
                </div>
                <div class="col-xs-4" rel="32">
                    <a href="javascript:;" class="btn">[ ]</a>
                </div>
            </div>
            <div class="row" rel="3">
                <div class="col-xs-4" rel="64">
                    <a href="javascript:;" class="btn">[ ]</a>
                </div>
                <div class="col-xs-4" rel="128">
                    <a href="javascript:;" class="btn">[ ]</a>
                </div>
                <div class="col-xs-4" rel="256">
                    <a href="javascript:;" class="btn">[ ]</a>
                </div>
            </div>
        </div>
        <script type="text/javascript" src="/js/jquery.min.js"></script>
        <script type="text/javascript" src="/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="/socket.io/socket.io.js"></script>
        <script type="text/javascript">
            $(function() {
                var $wr = $('.container');
                $wr.on('set', 'a.btn', function(e, data) {
                    var $this = $(this);
                    if (!!data.checked) {
                        $this.addClass('disabled').html(data.checked);
                    } else {
                        $this.removeClass('disabled').html('[' + data.votes + ']');
                    }
                });

                var socket = io();

                socket.on('game', function(gamedata) {
                    $.each(gamedata.board, function(key, data) {
                        var $cell = $('.col-xs-4[rel=' + data.id + '] a');
                        $cell.trigger('set', data);
                    })
                });


                socket.on('vote', function(data) {
                    $('.col-xs-4[rel=' + data.id + '] a').trigger('set', data);
                });

                $('a.btn').on('click', function(e) {
                    var $this = $(this);
                    var id = $this.closest('.col-xs-4').attr('rel');

                    socket.emit('vote', {
                        id: id
                    })
                });
            })
        </script>
    </body>
</html>